if(!empty($_POST)){

  if(isset($_POST["email"], $_POST["password"]) && !empty($_POST["email"]) && !empty($_POST["password"])){

    if(!filter_var($_POST["email"], FILTER_VALIDATE_EMAIL)) {

      echo "<h2 class='error'>Ce n'est pas une adresse e-mail valide</h2>";

    }

    require_once("composants/database.php");

    $sql = "SELECT * FROM users WHERE email = :email";

    $query = $db->prepare($sql);

    $query->bindValue(":email", $_POST["email"], PDO::PARAM_STR);
    $query->execute();

    $user = $query->fetch();

    if(!$user){

      echo "<h2 class='error'>Erreur lors de la tentative de connexion</h2>";

    } else {

      if(password_verify($_POST["password"], $user["password"])) {

        session_start();

        $_SESSION = [
          "lastname" => $user["lastname"],
          "firstname" => $user["firstname"],
          "email" => $user["email"],
          "birthday" => $user["birthday"],
          "country" => $user["country"],
          "city" => $user["city"]
        ];

        header("Location: fil-actualite.php");
        exit();

      } else {

        echo "<h2 class='error'>L'adresse e-mail et / ou le mot sont incorrect";

      }

    }
    
  }

}